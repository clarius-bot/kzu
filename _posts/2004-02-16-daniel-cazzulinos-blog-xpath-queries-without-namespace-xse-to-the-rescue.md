---
layout: post
title: "Daniel Cazzulino's Blog : XPath queries without namespace: XSE to the rescue"
date: 2004-02-16 00:00:00 +0000
---

Daniel Cazzulino's Blog : XPath queries without namespace: XSE to the rescue

### Search

[Go](javascript:__doPostBack\('_ctl0$_ctl0$_ctl0$_ctl0$BlogSideBar1$_ctl0$Singleweblogsearch1$_ctl0$SearchButton',''\))

### Subscriptions

  * [RSS 2.0](http://clariusconsulting.net/blogs/kzu/rss.aspx)
  * [Atom 0.3](http://clariusconsulting.net/blogs/kzu/atom.aspx)
  * [Contact](http://clariusconsulting.net/blogs/kzu/contact.aspx)

| [<](javascript:__doPostBack\('_ctl0$_ctl0$_ctl0$_ctl0$BlogSideBar1$_ctl0$Cal$_ctl0$PostCalendar','V3043'\))| June 2008| [>](javascript:__doPostBack\('_ctl0$_ctl0$_ctl0$_ctl0$BlogSideBar1$_ctl0$Cal$_ctl0$PostCalendar','V3104'\))  
---|---|---  
Su| Mo| Tu| We| Th| Fr| Sa  
25| 26| 27| 28| 29| 30| 31  
1| [2](http://clariusconsulting.net/blogs/kzu/archive/2004/2/2.aspx "3 Posts")| 3| [4](http://clariusconsulting.net/blogs/kzu/archive/2004/2/4.aspx "2 Posts")| 5| 6| 7  
8| 9| [10](http://clariusconsulting.net/blogs/kzu/archive/2004/2/10.aspx "2 Posts")| 11| [12](http://clariusconsulting.net/blogs/kzu/archive/2004/2/12.aspx "1 Post")| [13](http://clariusconsulting.net/blogs/kzu/archive/2004/2/13.aspx "1 Post")| 14  
15| [16](http://clariusconsulting.net/blogs/kzu/archive/2004/2/16.aspx "7 Posts")| [17](http://clariusconsulting.net/blogs/kzu/archive/2004/2/17.aspx "2 Posts")| [18](http://clariusconsulting.net/blogs/kzu/archive/2004/2/18.aspx "1 Post")| 19| [20](http://clariusconsulting.net/blogs/kzu/archive/2004/2/20.aspx "3 Posts")| 21  
22| [23](http://clariusconsulting.net/blogs/kzu/archive/2004/2/23.aspx "1 Post")| [24](http://clariusconsulting.net/blogs/kzu/archive/2004/2/24.aspx "1 Post")| [25](http://clariusconsulting.net/blogs/kzu/archive/2004/2/25.aspx "1 Post")| 26| [27](http://clariusconsulting.net/blogs/kzu/archive/2004/2/27.aspx "1 Post")| 28  
29| 30| 1| 2| 3| 4| 5  
  
[![Microsoft MVP Profile](https://web.archive.org/web/20080609024029im_/http://clariusconsulting.net/Themes/default/images/mvp-logo.gif)](http://aspnet2.com/mvp.ashx?kzu)

### News

[![](https://web.archive.org/web/20080609024029im_/http://www.feedburner.com/fb/images/pub/feed-icon16x16.png)](http://feeds.feedburner.com/DanielCazzulino) [](http://feeds.feedburner.com/DanielCazzulino) [![](https://web.archive.org/web/20080609024029im_/http://feeds.feedburner.com/~fc/DanielCazzulino?bg=FF6600&fg=FFFFFF&anim=1)](http://feeds.feedburner.com/DanielCazzulino)

[ ![](/web/20080609024029im_/http://clariusconsulting.net/img/mail-to-button.gif) Contact](http://clariusconsulting.net/blogs/kzu/contact.aspx)

### Post Categories

  * [.NET](http://clariusconsulting.net/blogs/kzu/archive/category/1023.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1023)
  * [All Technology](http://clariusconsulting.net/blogs/kzu/archive/category/1035.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1035)
  * [ASP.NET](http://clariusconsulting.net/blogs/kzu/archive/category/1024.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1024)
  * [Books](http://clariusconsulting.net/blogs/kzu/archive/category/1022.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1022)
  * [GAT](http://clariusconsulting.net/blogs/kzu/archive/category/1038.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1038)
  * [InSTEDD](http://clariusconsulting.net/blogs/kzu/archive/category/1064.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1064)
  * [Mesh](http://clariusconsulting.net/blogs/kzu/archive/category/1065.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1065)
  * [Miscelaneous](http://clariusconsulting.net/blogs/kzu/archive/category/1026.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1026)
  * [Moq](http://clariusconsulting.net/blogs/kzu/archive/category/1062.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1062)
  * [Movies](http://clariusconsulting.net/blogs/kzu/archive/category/1027.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1027)
  * [Patterns & Practices](http://clariusconsulting.net/blogs/kzu/archive/category/1037.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1037)
  * [PowerShell](http://clariusconsulting.net/blogs/kzu/archive/category/1055.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1055)
  * [Shadowfax](http://clariusconsulting.net/blogs/kzu/archive/category/1032.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1032)
  * [Software Factories](http://clariusconsulting.net/blogs/kzu/archive/category/1041.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1041)
  * [WPF](http://clariusconsulting.net/blogs/kzu/archive/category/1060.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1060)
  * [XML](http://clariusconsulting.net/blogs/kzu/archive/category/1021.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1021)

## XPath queries without namespace: XSE to the rescue 

[Dare](http://www.25hoursaday.com/weblog/PermaLink.aspx?guid=cd6f9ffd-5149-4872-b48c-0f95f4fdd3bf) has posted about issues with XPath and namespaces in documents. I'm by no means encouraging this, but if you don't care about namespaces, here's a solution for you.

[Using the](http://weblogs.asp.net/cazzu/posts/XseTransformations.aspx) [XSE reader](http://weblogs.asp.net/cazzu/posts/XseIntro.aspx) I proposed (~~and will upload real soon~~[ see the release post](http://weblogs.asp.net/cazzu/posts/XSERelease.aspx)), you can setup a handler to catch all elements and remove any namespaces whatsoever, at reading time (i.e. long before the document is loaded), as follows:

public class MyLoader { public XPathDocument Load(string uri) { TransformingXseReader xr = new TransformingXseReader(new XmlTextReader(uri)); XmlNamespaceManager mgr = new XmlNamespaceManager(xr.NameTable); xr.AddHandler(new RelativePath().Create("*", mgr), new EventHandler(OnElement)); XPathDocument doc = new XPathDocument(xr); return doc; } private void OnElement(object sender, EventArgs e) { TransformingXseReader tr = (TransformingXseReader) sender; tr.ChangeName(tr.LocalName, String.Empty); } }

The Whidbey version looks more compact:

public class MyLoader { public XPathDocument Load(string uri) { TransformingXseReader xr = new TransformingXseReader(new XmlTextReader(uri)); XmlNamespaceManager mgr = new XmlNamespaceManager(xr.NameTable); xr.AddHandler(new RelativePath().Create("*", mgr), delegate { xr.ChangeName(xr.LocalName, String.Empty); } XPathDocument doc = new XPathDocument(xr); return doc; } }

What you effectively get loaded is an infoset without element namespaces, therefore your XPath queries don't need to care about them anymore.

**Update: read these follow-up:**

  * [XPath vs pseudo-XPath](http://weblogs.asp.net/cazzu/archive/2004/02/16/PseudoXPath.aspx)
  * [XSE Initial Release](http://weblogs.asp.net/cazzu/archive/2004/02/16/XSERelease.aspx)
  * [XSE != XPath != SXPath != XPathReader](http://weblogs.asp.net/cazzu/archive/2004/02/16/XseNotXPath.aspx)

posted on Monday, February 16, 2004 9:49 AM by [kzu](http://clariusconsulting.net/user/Profile.aspx?UserID=1004)

[Post a Comment](http://clariusconsulting.net/blogs/kzu/comments/159.aspx) :: 

#### [#](http://clariusconsulting.net/blogs/kzu/archive/2004/02/16/XPathNonNS.aspx#492 "permalink") re: XPath queries without namespace: XSE to the rescue @ Friday, March 31, 2006 11:16 AM

Hi dear,   
My name Faris, I'm trying to use your code, but it is not working.   
  
Thanks for help.   
Fshomou@hotmail.com [](javascript:__doPostBack\('_ctl0$_ctl0$_ctl0$_ctl0$_ctl0$_ctl0$Comments$_ctl0$Comments$_ctl0$EditLink',''\))

[Faris](http://clariusconsulting.net/utility/Redirect.aspx?U=http://Fshomou@hotmail.com "Anonymous")

  

[![](/web/20080609024029im_/http://clariusconsulting.net/Themes/default/images/hdr-KZU.jpg)](http://clariusconsulting.net/blogs "Clarius Aggregated Blogs")