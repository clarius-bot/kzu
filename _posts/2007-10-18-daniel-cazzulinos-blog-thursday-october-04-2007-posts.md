---
layout: post
title: "Daniel Cazzulino's Blog : Thursday, October 04, 2007 - Posts"
date: 2007-10-18 00:00:00 +0000
---

Daniel Cazzulino's Blog : Thursday, October 04, 2007 - Posts


  * [RSS 2.0](http://clariusconsulting.net/blogs/kzu/rss.aspx)
  * [Atom 0.3](http://clariusconsulting.net/blogs/kzu/atom.aspx)
  * [Contact](http://clariusconsulting.net/blogs/kzu/contact.aspx)

| [<](javascript:__doPostBack\('_ctl0$_ctl0$_ctl0$_ctl0$BlogSideBar1$_ctl0$Cal$_ctl0$PostCalendar','V2800'\))| October 2007| [>](javascript:__doPostBack\('_ctl0$_ctl0$_ctl0$_ctl0$BlogSideBar1$_ctl0$Cal$_ctl0$PostCalendar','V2861'\))  
---|---|---  
Su| Mo| Tu| We| Th| Fr| Sa  
30| [1](http://clariusconsulting.net/blogs/kzu/archive/2007/10/1.aspx "1 Post")| 2| 3| [4](http://clariusconsulting.net/blogs/kzu/archive/2007/10/4.aspx "2 Posts")| 5| 6  
7| 8| 9| 10| 11| 12| 13  
14| 15| 16| 17| 18| 19| 20  
21| 22| 23| 24| 25| 26| 27  
28| 29| 30| 31| 1| 2| 3  
4| 5| 6| 7| 8| 9| 10  
  
[![Microsoft MVP Profile](https://web.archive.org/web/20071018152435im_/http://clariusconsulting.net/Themes/default/images/mvp-logo.gif)](http://aspnet2.com/mvp.ashx?kzu)

[![](https://web.archive.org/web/20071018152435im_/http://www.feedburner.com/fb/images/pub/feed-icon16x16.png)](http://feeds.feedburner.com/DanielCazzulino) [](http://feeds.feedburner.com/DanielCazzulino) [![](https://web.archive.org/web/20071018152435im_/http://feeds.feedburner.com/~fc/DanielCazzulino?bg=FF6600&fg=FFFFFF&anim=1)](http://feeds.feedburner.com/DanielCazzulino)

[ ![](/web/20071018152435im_/http://clariusconsulting.net/img/mail-to-button.gif) Contact](http://clariusconsulting.net/blogs/kzu/contact.aspx)

  * [.NET](http://clariusconsulting.net/blogs/kzu/archive/category/1023.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1023)
  * [All Technology](http://clariusconsulting.net/blogs/kzu/archive/category/1035.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1035)
  * [ASP.NET](http://clariusconsulting.net/blogs/kzu/archive/category/1024.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1024)
  * [Books](http://clariusconsulting.net/blogs/kzu/archive/category/1022.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1022)
  * [GAT](http://clariusconsulting.net/blogs/kzu/archive/category/1038.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1038)
  * [Miscelaneous](http://clariusconsulting.net/blogs/kzu/archive/category/1026.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1026)
  * [Movies](http://clariusconsulting.net/blogs/kzu/archive/category/1027.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1027)
  * [Patterns & Practices](http://clariusconsulting.net/blogs/kzu/archive/category/1037.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1037)
  * [PowerShell](http://clariusconsulting.net/blogs/kzu/archive/category/1055.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1055)
  * [Shadowfax](http://clariusconsulting.net/blogs/kzu/archive/category/1032.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1032)
  * [Software Factories](http://clariusconsulting.net/blogs/kzu/archive/category/1041.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1041)
  * [WPF](http://clariusconsulting.net/blogs/kzu/archive/category/1060.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1060)
  * [XML](http://clariusconsulting.net/blogs/kzu/archive/category/1021.aspx) [(rss)](http://clariusconsulting.net/blogs/kzu/rss.aspx?CategoryID=1021)

## Thursday, October 04, 2007 - Posts

#####  [Cool article if you are learning VS SDK](http://clariusconsulting.net/blogs/kzu/archive/2007/10/04/CoolarticleifyouarelearningVSSDK.aspx)

[Pablo](http://clariusconsulting.net/pga) wrote a very cool [article on the CoDe magazine](http://code-magazine.com/Article.aspx?quickid=0710092) which should be very useful to most people developing VS packages. With extensive screenshots and wizards, it should make your VS extensibility life MUCH easier.

Give it a shot!

posted [Thursday, October 04, 2007 3:19 PM](http://clariusconsulting.net/blogs/kzu/archive/2007/10/04/CoolarticleifyouarelearningVSSDK.aspx) by [kzu](http://clariusconsulting.net/user/Profile.aspx?UserID=1004) with [1 Comments](http://clariusconsulting.net/blogs/kzu/archive/2007/10/04/CoolarticleifyouarelearningVSSDK.aspx#comments)

#####  [How to get a System.Type from an EnvDTE.CodeTypeRef or EnvDTE.CodeClass](http://clariusconsulting.net/blogs/kzu/archive/2007/10/04/34019.aspx)

I have already [hinted at this in a previous post](http://www.clariusconsulting.net/blogs/kzu/archive/2006/01/06/GetTypesFromProject.aspx "Retrieving available types in current project and its references \(withoult locking\)"), but this time it's a bit different. Sometimes it's useful to switch to a full System.Type when you're doing code-generation or general CodeModel navigation within VS in an addin or VSSDK package.

The trick is to retrieve the [ITypeResolutionService](http://msdn2.microsoft.com/en-us/library/system.componentmodel.design.ityperesolutionservice.aspx) from the [DynamicType](http://msdn2.microsoft.com/en-us/library/Microsoft.VisualStudio.Shell.Design.DynamicTypeService.aspx) associated with the current project:
    
    
    private ITypeResolutionService GetResolutionService()
    {
        DynamicTypeService typeService = GetService<DynamicTypeService>();
        Debug.Assert(typeService != null, "No dynamic type service registered.");
    
        IVsSolution sln = GetService<IVsSolution>();
        IVsHierarchy hier;
        sln.GetProjectOfUniqueName(CurrentProject.Project.UniqueName, out hier);
    
        Debug.Assert(hier != null, "No active hierarchy is selected.");
    
        return typeService.GetTypeResolutionService(hier);
    }
    

[](http://11011.net/software/vspaste)

[GetService<T> is just a shorthand to an IServiceProvider.GetService call. The service provider should be the one associated with the current project]

With the resolver at hand, you can simply do:
    
    
    CodeTypeRef type = // some type you got  
    Type t = resolver.GetType(type.AsFullName, true);

or
    
    
    CodeClass cc = // some class you got  
    Type t = resolver.GetType(cc.FullName, true);

One caveat: this is very reliable if the type you're loading is external (i.e. it's CodeClass.InfoLocation == vsCMInfoLocation.vsCMInfoLocationExternal) but for classes on the current project, you'll get a type that contains the code from the last successful compilation. Alternatively, you can force a compilation before going this route, although I'd advise against it: it's not a very good user experience IMO.

posted [Thursday, October 04, 2007 1:20 PM](http://clariusconsulting.net/blogs/kzu/archive/2007/10/04/34019.aspx) by [kzu](http://clariusconsulting.net/user/Profile.aspx?UserID=1004) with [1 Comments](http://clariusconsulting.net/blogs/kzu/archive/2007/10/04/34019.aspx#comments)

  

[![](/web/20071018152435im_/http://clariusconsulting.net/Themes/default/images/hdr-KZU.jpg)](http://clariusconsulting.net/blogs "Clarius Aggregated Blogs")